{% extends "layout.html" %}

{% block title %}
    Profile - Spotify Stats
{% endblock %}

{% block main %}

    <div class="profile-page-container">
        <img src="{{ user_image }}" alt="Profile Image" class="profile-img">
    </div>


    <form method="POST" action="/update_settings" id="settings-form">
    <!-- Edit Button -->
    <div class="flex justify-end mb-4">
        <button type="button" onclick="toggleEdit()" class="text-blue-400 hover:text-blue-600">
            ✏️ Edit
        </button>
    </div>

    <!-- Custom Username -->
    <div class="mb-4">
        <label class="block font-medium text-white">Custom Username:</label>
        <p id="custom_username_display" class="text-white">{{ custom_username or 'Not set' }}</p>
        <input type="text" name="custom_username" value="{{ custom_username or '' }}"
               class="w-full p-2 rounded bg-gray-700 text-white hidden editable" />
    </div>

    <!-- Profile Bio -->
    <div class="mb-4">
        <label class="block font-medium text-white">Profile Bio:</label>
        <p id="bio_display" class="text-white">{{ bio or 'Not set' }}</p>
        <textarea name="bio" class="w-full p-2 rounded bg-gray-700 text-white hidden editable">{{ bio or '' }}</textarea>
    </div>

    <!-- Language -->
    <div class="mb-4">
        <label class="block font-medium text-white">Language:</label>
        <p id="language_display" class="text-white">{{ language or 'Not set' }}</p>
        <input name="language" value="{{ language or '' }}"
               class="w-full p-2 rounded bg-gray-700 text-white hidden editable" />
    </div>

    <!-- Time Zone -->
    <div class="mb-4">
        <label class="block font-medium text-white">Time Zone:</label>
        <p id="timezone_display" class="text-white">{{ timezone or 'Not set' }}</p>
        <input name="timezone" value="{{ timezone or '' }}"
               class="w-full p-2 rounded bg-gray-700 text-white hidden editable" />
    </div>

    <!-- Save & Cancel Buttons -->
    <div class="flex justify-between mt-6 hidden editable" id="action-buttons">
        <div>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-dark px-4 py-2 rounded mr-2">Save Settings</button>
            <button type="button" onclick="cancelEdit()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Cancel</button>
        </div>
        <a href="/disconnect" class="text-red-600 hover:underline self-center">Disconnect Spotify</a>
    </div>
</form>
<script>
    function toggleEdit() {
        document.querySelectorAll('.editable').forEach(el => el.classList.remove('hidden'));
        document.querySelectorAll('#settings-form p').forEach(el => el.classList.add('hidden'));
    }

    function cancelEdit() {
        document.querySelectorAll('.editable').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('#settings-form p').forEach(el => el.classList.remove('hidden'));

        // Optionally, reset values (if they were changed) — refreshes the page
        // location.reload();
    }
</script>


{% endblock %}
